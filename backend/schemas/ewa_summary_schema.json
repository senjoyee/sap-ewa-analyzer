{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/god_level_ewa_analysis/v1.1.json",
  "title": "GodLevelEWAAnalysis",
  "description": "Structured, actionable analysis of an SAP EarlyWatch Alert report.",
  "type": "object",
  "properties": {
    "schema_version": {
      "type": "string",
      "const": "1.1"
    },

    "system_metadata": {
      "type": "object",
      "required": ["system_id", "report_date", "analysis_period"],
      "properties": {
        "system_id": {
          "type": "string",
          "description": "The SAP System ID (SID)."
        },
        "report_date": {
          "type": "string",
          "format": "date",
          "description": "Date the EWA report was generated."
        },
        "analysis_period": {
          "type": "string",
          "description": "Date range the report covers (e.g. 2024-05-01 / 2024-05-31)."
        }
      }
    },

    "system_health_overview": {
      "type": "object",
      "properties": {
        "performance": { "type": "string", "enum": ["Good", "Fair", "Poor"] },
        "security":    { "type": "string", "enum": ["Good", "Fair", "Poor"] },
        "stability":   { "type": "string", "enum": ["Good", "Fair", "Poor"] },
        "configuration": { "type": "string", "enum": ["Good", "Fair", "Poor"] }
      }
    },

    "executive_summary": {
      "type": "string",
      "description": "Concise bullet-point summary for a C-level audience."
    },

    "positive_findings": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["area", "description"],
        "properties": {
          "area":        { "type": "string" },
          "description": { "type": "string" }
        }
      }
    },

    "key_findings": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "area", "finding", "impact", "business_impact", "severity"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^KF-[0-9]{3}$",
            "description": "Unique key finding identifier."
          },
          "area":            { "type": "string" },
          "finding":         { "type": "string" },
          "impact":          { "type": "string", "description": "Potential technical impact." },
          "business_impact": { "type": "string", "description": "Translated business risk." },
          "severity":        { "type": "string", "enum": ["Low", "Medium", "High", "Critical"] }
        }
      }
    },

    "recommendations": {
      "type": "array",
      "description": "Detailed, actionable recommendations.",
      "items": {
        "type": "object",
        "required": [
          "recommendation_id",
          "priority",
          "estimated_effort",
          "responsible_area",
          "action",
          "validation_step",
          "preventative_action"
        ],
        "properties": {
          "recommendation_id": {
            "type": "string",
            "pattern": "^REC-[0-9]{3}$"
          },
          "priority": { "type": "string", "enum": ["High", "Medium", "Low"] },

          "estimated_effort": {
            "type": "object",
            "required": ["analysis", "implementation"],
            "properties": {
              "analysis":      { "type": "string", "enum": ["Low", "Medium", "High"] },
              "implementation":{ "type": "string", "enum": ["Low", "Medium", "High"] }
            }
          },

          "responsible_area": { "type": "string" },
          "linked_issue_id": {
            "type": "string",
            "pattern": "^KF-[0-9]{3}$",
            "description": "Key finding this recommendation addresses."
          },
          "action":             { "type": "string", "description": "Specific steps to execute." },
          "validation_step":    { "type": "string", "description": "How to confirm the fix was effective." },
          "preventative_action":{ "type": "string", "description": "Measure to prevent recurrence." }
        }
      }
    },

    "parameters": {
      "type": "array",
      "description": "Relevant SAP profile parameters.",
      "items": {
        "type": "object",
        "required": ["name", "area", "current_value", "recommended_value", "description"],
        "properties": {
          "name":              { "type": "string" },
          "area":              { "type": "string" },
          "current_value":     { "type": "string" },
          "recommended_value": { "type": "string" },
          "description":       { "type": "string" }
        }
      }
    },


    "trend_analysis": {
      "type": "object",
      "properties": {
        "kpi_trends": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "kpi_name":         { "type": "string" },
              "previous_value":   { "type": "string" },
              "current_value":    { "type": "string" },
              "change_percentage":{ "type": "number" }
            }
          }
        },
        "performance_trend": { "type": "string", "enum": ["Improving", "Stable", "Degrading"] },
        "stability_trend":   { "type": "string", "enum": ["Improving", "Stable", "Degrading"] },
        "summary":           { "type": "string" }
      }
    },

    "capacity_outlook": {
      "type": "object",
      "properties": {
        "database_growth":   { "type": "string" },
        "cpu_utilization":   { "type": "string" },
        "memory_utilization":{ "type": "string" },
        "summary":           { "type": "string" }
      }
    },

    "benchmarking": {
      "type": "object",
      "description": "Comparison versus industry norms.",
      "properties": {
        "comparison": { "type": "string" },
        "summary":    { "type": "string" }
      }
    },

    "overall_risk": {
      "type": "string",
      "enum": ["Low", "Medium", "High", "Critical"]
    }
  },

  "required": [
    "schema_version",
    "system_metadata",
    "executive_summary",
    "system_health_overview",
    "positive_findings",
    "key_findings",
    "recommendations",
    "parameters",

    "trend_analysis",
    "capacity_outlook",
    "benchmarking",
    "overall_risk"
  ],

  "$defs": {
    "recommendation_item": {
      "type": "object",
      "required": [
        "recommendation_id",
        "priority",
        "estimated_effort",
        "responsible_area",
        "action",
        "validation_step",
        "preventative_action"
      ],
      "properties": {
        "recommendation_id": { "type": "string", "pattern": "^REC-[0-9]{3}$" },
        "priority": { "type": "string", "enum": ["High", "Medium", "Low"] },
        "estimated_effort": {
          "type": "object",
          "required": ["analysis", "implementation"],
          "properties": {
            "analysis":      { "type": "string", "enum": ["Low", "Medium", "High"] },
            "implementation":{ "type": "string", "enum": ["Low", "Medium", "High"] }
          }
        },
        "responsible_area":  { "type": "string" },
        "linked_issue_id":   { "type": "string", "pattern": "^KF-[0-9]{3}$" },
        "action":            { "type": "string" },
        "validation_step":   { "type": "string" },
        "preventative_action":{ "type": "string" }
      }
    }
  }
}